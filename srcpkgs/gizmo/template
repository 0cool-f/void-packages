# Template file for 'gizmo'
pkgname=gizmo
version=0.1.9
revision=1
_commit=67d2ab3cc6b3fd85cd7257211f176ccbf7d9dab3
build_style=go
go_import_path=github.com/gizmo-platform/gizmo
go_ldflags="-X ${go_import_path}/pkg/buildinfo.Version=${version}
 -X ${go_import_path}/pkg/buildinfo.Commit=${_commit}"
short_desc="Software for the Gizmo Mechatronics Platform"
maintainer="Michael Aldridge <maldridge@gizmoplatform.org>"
license="ISC"
homepage="https://gizmoplatform.org"
distfiles="https://github.com/gizmo-platform/gizmo/archive/refs/tags/v${version}.tar.gz"
checksum=06bb79e02196b979967aca0f7765a33700bdab2cd6b45be541e8592566baed2e

post_install() {
	vsv gizmo-fms
	vlicense LICENSE
}

gizmo-fms_package() {
	short_desc+=" - FMS"
	depends="${sourcepkg}>=${version}_${revision} apache-htpasswd dialog terraform"
	make_dirs="/var/lib/gizmo 0755 _gizmo _gizmo"
	system_accounts="_gizmo"
	_gizmo_homedir="/var/lib/gizmo"
	_gizmo_shell="/bin/nologin"
	_gizmo_descr="Unprivileged service account"

	pkg_install() {
		vmove etc/sv/gizmo-fms
	}
}
